yet another iteration, resolving some problems with earlier one, while keeping the earlier version in go8 to easily come back to it if needed
